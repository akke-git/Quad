**제품 요구사항 문서 (PRD)**

### 1. 목적 및 범위

- **목적:** 사용자의 기존 React/Next.js 개인 홈페이지에 고음질 YouTube 오디오 다운로드 기능을 메뉴로 추가한다.
- **범위:** 검색, 다운로드, 변환, 메타데이터 태깅을 위한 백엔드 서비스 및 사용자 상호작용·모니터링·관리용 프론트엔드 통합.

### 2. 배경 및 문제 정의

- YouTube에 방대한 음악 콘텐츠가 존재하지만, 고음질 오디오를 추출하려면 여러 도구와 수작업이 필요하다.
- 사용자는 하나의 웹 인터페이스에서 곡명·아티스트로 검색하고 무손실 또는 고비트레이트 오디오 파일을 직접 다운로드하길 원한다.

### 3. 목표 및 성공 지표

- **사용자 목표:**

  - 웹 UI에서 곡명 또는 아티스트로 검색.
  - FLAC 또는 320kbps MP3 형식으로 올바른 메타데이터와 함께 다운로드.

- **비즈니스 목표:**

  - 개인용 서비스로 소수 사용자(최대 5명)에게 안정적이고 일관된 경험 제공.
  - 95% 이상의 다운로드 성공률 유지.

- **지표:**

  1. 총 다운로드 건수
  2. 다운로드 성공률
  3. 사용자 만족도(간단한 설문 또는 피드백 수집)

### 4. 사용자 페르소나 사용자 페르소나

- **음악 애호가:** 희귀 라이브 녹음을 오프라인으로 듣고 싶어 함.
- **팟캐스터/리믹스 아티스트:** 고음질 스템(audio stems)을 빠르게 확보하고자 함.
- **웹 취미 개발자:** 개인 사이트에서 포트폴리오 및 도구로 활용.

### 5. 사용 사례 및 사용자 스토리

- **UC1: 검색 및 미리보기**

  - 음악 애호가로서 "Bohemian Rhapsody Queen"을 검색하면 썸네일, 재생 시간 정보가 보이길 원함.
  - US1.1: 제목, 채널명, 가능한 비트레이트 정보를 표시.

- **UC2: 오디오 다운로드**

  - 팟캐스트 제작자로서 최고 품질의 오디오 스트림을 FLAC으로 다운로드하길 원함.
  - US2.1: 형식 선택 옵션 제공(FLAC, MP3-320).

- **UC3: 메타데이터 수정**

  - 음악 아카이브 담당자로서 파일에 아티스트, 앨범, 커버 이미지가 태그팅되길 원함.
  - US3.1: AcoustID/MusicBrainz 지문 조회 옵션 제공.

- **UC4: 다운로드 이력**

  - 웹 취미 개발자로서 최근 10건의 다운로드 내역을 보고 실패 시 재시도하길 원함.
  - US4.1: 로컬 IndexedDB 또는 백엔드 DB에 이력 저장.

### 6. 기능 요구사항

- **FR1: 검색 API:** GET `/api/search?q={query}` → 비디오 목록(JSON: id, 제목, 채널, 재생시간, 오디오 품질 태그)
- **FR2: 다운로드 API:** POST `/api/download`({ videoId, format }) → jobId 반환
- **FR3: 작업 상태 조회:** GET `/api/job/{jobId}` → 진행 상태, 오류, 다운로드 URL 반환
- **FR4: 메타데이터 서비스:** GET `/api/metadata/{jobId}` → ID3/FLAC 태그 조회 및 삽입
- **FR5: 이력 서비스:** GET `/api/history`, POST `/api/history/{id}/retry` 엔드포인트 제공

### 7. 기술 아키텍처

- **백엔드** (Node.js 또는 Python) on Vercel Serverless / AWS Lambda:

  - `yt-dlp` 로 스트림 추출
  - `FFmpeg` 으로 오디오 변환
  - `Chromaprint`/`pyacoustid` + MusicBrainz 태깅
  - 작업 큐: Redis + BullMQ 또는 RabbitMQ
  - 저장소: S3 또는 Vercel Blob
  - 데이터베이스: DynamoDB 또는 MongoDB Atlas

- **프론트엔드** (React + Next.js) 기존 코드베이스 내:

  - `/downloads` 라우트에 메뉴 추가
  - 컴포넌트: SearchBar, VideoList, FormatSelector, JobProgressModal, HistoryTable
  - 상태 관리: React Context 또는 Redux

### 8. UI/UX 및 상호작용 흐름

1. **메뉴 선택:** 네비게이션 바에서 "Music Downloader" 클릭
2. **검색 페이지:** 입력창 및 최근 검색어 표시
3. **결과 리스트:** 썸네일, 제목, 다운로드 형식 옵션 표시
4. **다운로드 실행:** 진행 중 모달(프로그레스 바, 취소 버튼) 오픈
5. **완료:** 다운로드 링크 제공, 24시간 후 임시 파일 자동 삭제
6. **이력 탭:** 과거 다운로드 목록, 상태 확인, 재시도/삭제 기능

### 9. 비기능 요구사항

- **성능:** 개인용 소수 사용자 대상이므로 응답 속도는 큰 이슈가 아니며, 평균 응답 시간 1초 이내를 목표로 함.
